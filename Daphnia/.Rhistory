# gamma *(death1*dalgae + death2*(dalgae^2)) -
(1-amm_param_b)*dammonium
ddaph_j <- sat_fun(fec_a,fec_b,dalgae)*daph_a - daph_j*(35/70)
#daphnia adults are added from growth by juveniles and are lost from death
ddaph_a <- 1/(sat_fun(growth_a,growth_b,dalgae))*daph_j- daph_a*(1/death_b)
ddalgae <- beta * dalgae*dammonium*alpha*omega/(omega+dammonium) - death1*dalgae - death2*(dalgae^2)-
daph_a*a_feed_m*dalgae - daph_j*j_feed_m*dalgae
# return the rate of change
list(c(ddammonium, ddaph_j,ddaph_a,ddalgae))
}) # end with(as.list ...
}
out <- ode(y = state, times = seq(0,100,0.1), func = d_equations, parms = parameters)
plot(out)
tail(out)
d_equations <-function(t, state, parameters) {
with(as.list(c(state, parameters)),{
# rate of change
# ammonium is added from release by both juvenile and adult daphnia
ddammonium <- daph_a*a_exc_m + daph_j*j_exc_m -  ## need to fix excretion- not right
dalgae*dammonium*alpha*omega/(omega+dammonium) +
# ((dammonium*alpha*omega/(omega+dammonium))) * (death1*dalgae + death2*(dalgae^2)) -
gamma *(death1*dalgae + death2*(dalgae^2)) -
# lagvalue(t - 5, 1) -
(1-amm_param_b)*dammonium
ddaph_j <- sat_fun(fec_a,fec_b,dalgae)*daph_a - daph_j*(35/70)
#daphnia adults are added from growth by juveniles and are lost from death
ddaph_a <- 1/(sat_fun(growth_a,growth_b,dalgae))*daph_j- daph_a*(1/death_b)
ddalgae <- beta * dalgae*dammonium*alpha*omega/(omega+dammonium) - death1*dalgae - death2*(dalgae^2)-
daph_a*a_feed_m*dalgae - daph_j*j_feed_m*dalgae
# return the rate of change
list(c(ddammonium, ddaph_j,ddaph_a,ddalgae))
}) # end with(as.list ...
}
out <- ode(y = state, times = seq(0,100,0.1), func = d_equations, parms = parameters)
plot(out)
tail(out)
d_equations <-function(t, state, parameters) {
with(as.list(c(state, parameters)),{
# rate of change
# ammonium is added from release by both juvenile and adult daphnia
ddammonium <- daph_a*a_exc_m + daph_j*j_exc_m -  ## need to fix excretion- not right
dalgae*dammonium*alpha*omega/(omega+dammonium) +
# ((dammonium*alpha*omega/(omega+dammonium))) * (death1*dalgae + death2*(dalgae^2)) -
gamma * (death1*dalgae + death2*(dalgae^2)) -
# lagvalue(t - 5, 1) -
(1-amm_param_b)*dammonium
ddaph_j <- sat_fun(fec_a,fec_b,dalgae)*daph_a - daph_j*(35/70)
#daphnia adults are added from growth by juveniles and are lost from death
ddaph_a <- 1/(sat_fun(growth_a,growth_b,dalgae))*daph_j- daph_a*(1/death_b)
ddalgae <- beta * dalgae*dammonium*alpha*omega/(omega+dammonium) - death1*dalgae - death2*(dalgae^2)-
daph_a*a_feed_m*dalgae - daph_j*j_feed_m*dalgae
# return the rate of change
list(c(ddammonium, ddaph_j,ddaph_a,ddalgae))
}) # end with(as.list ...
}
out <- ode(y = state, times = seq(0,200,0.1), func = d_equations, parms = parameters)
plot(out)
tail(out)
out <- ode(y = state, times = seq(0,300,0.1), func = d_equations, parms = parameters)
plot(out)
tail(out)
d_equations <-function(t, state, parameters) {
with(as.list(c(state, parameters)),{
# rate of change
# ammonium is added from release by both juvenile and adult daphnia
ddammonium <- daph_a*a_exc_m + daph_j*j_exc_m -  ## need to fix excretion- not right
dalgae*dammonium*alpha*omega/(omega+dammonium) +
# ((dammonium*alpha*omega/(omega+dammonium))) * (death1*dalgae + death2*(dalgae^2)) -
gamma/10 * (death1*dalgae + death2*(dalgae^2)) -
# lagvalue(t - 5, 1) -
(1-amm_param_b)*dammonium
ddaph_j <- sat_fun(fec_a,fec_b,dalgae)*daph_a - daph_j*(35/70)
#daphnia adults are added from growth by juveniles and are lost from death
ddaph_a <- 1/(sat_fun(growth_a,growth_b,dalgae))*daph_j- daph_a*(1/death_b)
ddalgae <- beta * dalgae*dammonium*alpha*omega/(omega+dammonium) - death1*dalgae - death2*(dalgae^2)-
daph_a*a_feed_m*dalgae - daph_j*j_feed_m*dalgae
# return the rate of change
list(c(ddammonium, ddaph_j,ddaph_a,ddalgae))
}) # end with(as.list ...
}
out <- ode(y = state, times = seq(0,300,0.1), func = d_equations, parms = parameters)
plot(out)
tail(out)
d_equations <-function(t, state, parameters) {
with(as.list(c(state, parameters)),{
# rate of change
# ammonium is added from release by both juvenile and adult daphnia
ddammonium <- daph_a*a_exc_m + daph_j*j_exc_m -  ## need to fix excretion- not right
dalgae*dammonium*alpha*omega/(omega+dammonium) +
# ((dammonium*alpha*omega/(omega+dammonium))) * (death1*dalgae + death2*(dalgae^2)) -
gamma/5 * (death1*dalgae + death2*(dalgae^2)) -
# lagvalue(t - 5, 1) -
(1-amm_param_b)*dammonium
ddaph_j <- sat_fun(fec_a,fec_b,dalgae)*daph_a - daph_j*(35/70)
#daphnia adults are added from growth by juveniles and are lost from death
ddaph_a <- 1/(sat_fun(growth_a,growth_b,dalgae))*daph_j- daph_a*(1/death_b)
ddalgae <- beta * dalgae*dammonium*alpha*omega/(omega+dammonium) - death1*dalgae - death2*(dalgae^2)-
daph_a*a_feed_m*dalgae - daph_j*j_feed_m*dalgae
# return the rate of change
list(c(ddammonium, ddaph_j,ddaph_a,ddalgae))
}) # end with(as.list ...
}
out <- ode(y = state, times = seq(0,300,0.1), func = d_equations, parms = parameters)
plot(out)
tail(out)
d_equations <-function(t, state, parameters) {
with(as.list(c(state, parameters)),{
# rate of change
# ammonium is added from release by both juvenile and adult daphnia
ddammonium <- daph_a*a_exc_m + daph_j*j_exc_m -  ## need to fix excretion- not right
dalgae*dammonium*alpha*omega/(omega+dammonium) +
# ((dammonium*alpha*omega/(omega+dammonium))) * (death1*dalgae + death2*(dalgae^2)) -
gamma/3 * (death1*dalgae + death2*(dalgae^2)) -
# lagvalue(t - 5, 1) -
(1-amm_param_b)*dammonium
ddaph_j <- sat_fun(fec_a,fec_b,dalgae)*daph_a - daph_j*(35/70)
#daphnia adults are added from growth by juveniles and are lost from death
ddaph_a <- 1/(sat_fun(growth_a,growth_b,dalgae))*daph_j- daph_a*(1/death_b)
ddalgae <- beta * dalgae*dammonium*alpha*omega/(omega+dammonium) - death1*dalgae - death2*(dalgae^2)-
daph_a*a_feed_m*dalgae - daph_j*j_feed_m*dalgae
# return the rate of change
list(c(ddammonium, ddaph_j,ddaph_a,ddalgae))
}) # end with(as.list ...
}
out <- ode(y = state, times = seq(0,300,0.1), func = d_equations, parms = parameters)
plot(out)
tail(out)
out <- ode(y = state, times = seq(0,300,0.1), func = d_equations, parms = parameters)
plot(out)
tail(out)
d_equations <-function(t, state, parameters) {
with(as.list(c(state, parameters)),{
# rate of change
# ammonium is added from release by both juvenile and adult daphnia
ddammonium <- daph_a*a_exc_m + daph_j*j_exc_m -  ## need to fix excretion- not right
dalgae*dammonium*alpha*omega/(omega+dammonium) +
# ((dammonium*alpha*omega/(omega+dammonium))) * (death1*dalgae + death2*(dalgae^2)) -
gamma/2 * (death1*dalgae + death2*(dalgae^2)) -
# lagvalue(t - 5, 1) -
(1-amm_param_b)*dammonium
ddaph_j <- sat_fun(fec_a,fec_b,dalgae)*daph_a - daph_j*(35/70)
#daphnia adults are added from growth by juveniles and are lost from death
ddaph_a <- 1/(sat_fun(growth_a,growth_b,dalgae))*daph_j- daph_a*(1/death_b)
ddalgae <- beta * dalgae*dammonium*alpha*omega/(omega+dammonium) - death1*dalgae - death2*(dalgae^2)-
daph_a*a_feed_m*dalgae - daph_j*j_feed_m*dalgae
# return the rate of change
list(c(ddammonium, ddaph_j,ddaph_a,ddalgae))
}) # end with(as.list ...
}
out <- ode(y = state, times = seq(0,300,0.1), func = d_equations, parms = parameters)
plot(out)
d_equations <-function(t, state, parameters) {
with(as.list(c(state, parameters)),{
# rate of change
# ammonium is added from release by both juvenile and adult daphnia
ddammonium <- daph_a*a_exc_m + daph_j*j_exc_m -  ## need to fix excretion- not right
dalgae*dammonium*alpha*omega/(omega+dammonium) +
# ((dammonium*alpha*omega/(omega+dammonium))) * (death1*dalgae + death2*(dalgae^2)) -
gamma/2.5 * (death1*dalgae + death2*(dalgae^2)) -
# lagvalue(t - 5, 1) -
(1-amm_param_b)*dammonium
ddaph_j <- sat_fun(fec_a,fec_b,dalgae)*daph_a - daph_j*(35/70)
#daphnia adults are added from growth by juveniles and are lost from death
ddaph_a <- 1/(sat_fun(growth_a,growth_b,dalgae))*daph_j- daph_a*(1/death_b)
ddalgae <- beta * dalgae*dammonium*alpha*omega/(omega+dammonium) - death1*dalgae - death2*(dalgae^2)-
daph_a*a_feed_m*dalgae - daph_j*j_feed_m*dalgae
# return the rate of change
list(c(ddammonium, ddaph_j,ddaph_a,ddalgae))
}) # end with(as.list ...
}
out <- ode(y = state, times = seq(0,300,0.1), func = d_equations, parms = parameters)
plot(out)
tail(out)
d_equations <-function(t, state, parameters) {
with(as.list(c(state, parameters)),{
# rate of change
# ammonium is added from release by both juvenile and adult daphnia
ddammonium <- daph_a*a_exc_m + daph_j*j_exc_m -  ## need to fix excretion- not right
dalgae*dammonium*alpha*omega/(omega+dammonium) +
# ((dammonium*alpha*omega/(omega+dammonium))) * (death1*dalgae + death2*(dalgae^2)) -
gamma/2 * (death1*dalgae + death2*(dalgae^2)) -
# lagvalue(t - 5, 1) -
(1-amm_param_b)*dammonium
ddaph_j <- sat_fun(fec_a,fec_b,dalgae)*daph_a - daph_j*(35/70)
#daphnia adults are added from growth by juveniles and are lost from death
ddaph_a <- 1/(sat_fun(growth_a,growth_b,dalgae))*daph_j- daph_a*(1/death_b)
ddalgae <- beta * dalgae*dammonium*alpha*omega/(omega+dammonium) - death1*dalgae - death2*(dalgae^2)-
daph_a*a_feed_m*dalgae - daph_j*j_feed_m*dalgae
# return the rate of change
list(c(ddammonium, ddaph_j,ddaph_a,ddalgae))
}) # end with(as.list ...
}
out <- ode(y = state, times = seq(0,300,0.1), func = d_equations, parms = parameters)
plot(out)
tail(out)
parameters
d_equations <-function(t, state, parameters) {
with(as.list(c(state, parameters)),{
# rate of change
# ammonium is added from release by both juvenile and adult daphnia
ddammonium <- daph_a*a_exc_m + daph_j*j_exc_m -  ## need to fix excretion- not right
dalgae*dammonium*alpha*omega/(omega+dammonium) +
((dammonium*alpha*omega/(omega+dammonium)) * 100) * (death1*dalgae + death2*(dalgae^2)) -
# gamma * (death1*dalgae + death2*(dalgae^2)) -
# lagvalue(t - 5, 1) -
(1-amm_param_b)*dammonium
ddaph_j <- sat_fun(fec_a,fec_b,dalgae)*daph_a - daph_j*(35/70)
#daphnia adults are added from growth by juveniles and are lost from death
ddaph_a <- 1/(sat_fun(growth_a,growth_b,dalgae))*daph_j- daph_a*(1/death_b)
ddalgae <- beta * dalgae*dammonium*alpha*omega/(omega+dammonium) - death1*dalgae - death2*(dalgae^2)-
daph_a*a_feed_m*dalgae - daph_j*j_feed_m*dalgae
# return the rate of change
list(c(ddammonium, ddaph_j,ddaph_a,ddalgae))
}) # end with(as.list ...
}
out <- ode(y = state, times = seq(0,300,0.1), func = d_equations, parms = parameters)
plot(out)
tail(out)
d_equations <-function(t, state, parameters) {
with(as.list(c(state, parameters)),{
# rate of change
# ammonium is added from release by both juvenile and adult daphnia
ddammonium <- daph_a*a_exc_m + daph_j*j_exc_m -  ## need to fix excretion- not right
dalgae*dammonium*alpha*omega/(omega+dammonium) +
((dammonium*alpha*omega/(omega+dammonium)) * 10) * (death1*dalgae + death2*(dalgae^2)) -
# gamma * (death1*dalgae + death2*(dalgae^2)) -
# lagvalue(t - 5, 1) -
(1-amm_param_b)*dammonium
ddaph_j <- sat_fun(fec_a,fec_b,dalgae)*daph_a - daph_j*(35/70)
#daphnia adults are added from growth by juveniles and are lost from death
ddaph_a <- 1/(sat_fun(growth_a,growth_b,dalgae))*daph_j- daph_a*(1/death_b)
ddalgae <- beta * dalgae*dammonium*alpha*omega/(omega+dammonium) - death1*dalgae - death2*(dalgae^2)-
daph_a*a_feed_m*dalgae - daph_j*j_feed_m*dalgae
# return the rate of change
list(c(ddammonium, ddaph_j,ddaph_a,ddalgae))
}) # end with(as.list ...
}
plot(out)
out <- ode(y = state, times = seq(0,300,0.1), func = d_equations, parms = parameters)
tail(out)
plot(out)
d_equations <-function(t, state, parameters) {
with(as.list(c(state, parameters)),{
# rate of change
# ammonium is added from release by both juvenile and adult daphnia
ddammonium <- daph_a*a_exc_m + daph_j*j_exc_m -  ## need to fix excretion- not right
dalgae*dammonium*alpha*omega/(omega+dammonium) +
((dammonium*alpha*omega/(omega+dammonium)) / 10) * (death1*dalgae + death2*(dalgae^2)) -
# gamma * (death1*dalgae + death2*(dalgae^2)) -
# lagvalue(t - 5, 1) -
(1-amm_param_b)*dammonium
ddaph_j <- sat_fun(fec_a,fec_b,dalgae)*daph_a - daph_j*(35/70)
#daphnia adults are added from growth by juveniles and are lost from death
ddaph_a <- 1/(sat_fun(growth_a,growth_b,dalgae))*daph_j- daph_a*(1/death_b)
ddalgae <- beta * dalgae*dammonium*alpha*omega/(omega+dammonium) - death1*dalgae - death2*(dalgae^2)-
daph_a*a_feed_m*dalgae - daph_j*j_feed_m*dalgae
# return the rate of change
list(c(ddammonium, ddaph_j,ddaph_a,ddalgae))
}) # end with(as.list ...
}
out <- ode(y = state, times = seq(0,300,0.1), func = d_equations, parms = parameters)
plot(out)
d_equations <-function(t, state, parameters) {
with(as.list(c(state, parameters)),{
# rate of change
# ammonium is added from release by both juvenile and adult daphnia
ddammonium <- daph_a*a_exc_m + daph_j*j_exc_m -  ## need to fix excretion- not right
dalgae*dammonium*alpha*omega/(omega+dammonium) +
# ((dammonium*alpha*omega/(omega+dammonium)) / 10) * (death1*dalgae + death2*(dalgae^2)) -
gamma/2.2 * (death1*dalgae + death2*(dalgae^2)) -
# lagvalue(t - 5, 1) -
(1-amm_param_b)*dammonium
ddaph_j <- sat_fun(fec_a,fec_b,dalgae)*daph_a - daph_j*(35/70)
#daphnia adults are added from growth by juveniles and are lost from death
ddaph_a <- 1/(sat_fun(growth_a,growth_b,dalgae))*daph_j- daph_a*(1/death_b)
ddalgae <- beta * dalgae*dammonium*alpha*omega/(omega+dammonium) - death1*dalgae - death2*(dalgae^2)-
daph_a*a_feed_m*dalgae - daph_j*j_feed_m*dalgae
# return the rate of change
list(c(ddammonium, ddaph_j,ddaph_a,ddalgae))
}) # end with(as.list ...
}
out <- ode(y = state, times = seq(0,300,0.1), func = d_equations, parms = parameters)
plot(out)
tail(out)
out <- ode(y = state, times = seq(0,800,0.1), func = d_equations, parms = parameters)
plot(out)
tail(out)
d_equations <-function(t, state, parameters) {
with(as.list(c(state, parameters)),{
# rate of change
# ammonium is added from release by both juvenile and adult daphnia
ddammonium <- daph_a*a_exc_m + daph_j*j_exc_m -  ## need to fix excretion- not right
dalgae*dammonium*alpha*omega/(omega+dammonium) +
# ((dammonium*alpha*omega/(omega+dammonium)) / 10) * (death1*dalgae + death2*(dalgae^2)) -
gamma * (death1*dalgae + death2*(dalgae^2)) -
# lagvalue(t - 5, 1) -
(1-amm_param_b)*dammonium
ddaph_j <- sat_fun(fec_a,fec_b,dalgae)*daph_a - daph_j*(35/70)
#daphnia adults are added from growth by juveniles and are lost from death
ddaph_a <- 1/(sat_fun(growth_a,growth_b,dalgae))*daph_j- daph_a*(1/death_b)
ddalgae <- beta * dalgae*dammonium*alpha*omega/(omega+dammonium) - death1*dalgae - death2*(dalgae^2)-
daph_a*a_feed_m*dalgae - daph_j*j_feed_m*dalgae
# return the rate of change
list(c(ddammonium, ddaph_j,ddaph_a,ddalgae))
}) # end with(as.list ...
}
out <- ode(y = state, times = seq(0,800,0.1), func = d_equations, parms = parameters)
plot(out)
tail(out)
d_equations <-function(t, state, parameters) {
with(as.list(c(state, parameters)),{
# rate of change
# ammonium is added from release by both juvenile and adult daphnia
ddammonium <- daph_a*a_exc_m + daph_j*j_exc_m -  ## need to fix excretion- not right
dalgae*dammonium*alpha*omega/(omega+dammonium) +
# ((dammonium*alpha*omega/(omega+dammonium)) / 10) * (death1*dalgae + death2*(dalgae^2)) -
gamma/4 * (death1*dalgae + death2*(dalgae^2)) -
# lagvalue(t - 5, 1) -
(1-amm_param_b)*dammonium
ddaph_j <- sat_fun(fec_a,fec_b,dalgae)*daph_a - daph_j*(35/70)
#daphnia adults are added from growth by juveniles and are lost from death
ddaph_a <- 1/(sat_fun(growth_a,growth_b,dalgae))*daph_j- daph_a*(1/death_b)
ddalgae <- beta * dalgae*dammonium*alpha*omega/(omega+dammonium) - death1*dalgae - death2*(dalgae^2)-
daph_a*a_feed_m*dalgae - daph_j*j_feed_m*dalgae
# return the rate of change
list(c(ddammonium, ddaph_j,ddaph_a,ddalgae))
}) # end with(as.list ...
}
out <- ode(y = state, times = seq(0,800,0.1), func = d_equations, parms = parameters)
plot(out)
tail(out)
out <- ode(y = state, times = seq(0,100,0.1), func = d_equations, parms = parameters)
plot(out)
tail(out)
d_equations <-function(t, state, parameters) {
with(as.list(c(state, parameters)),{
# rate of change
# ammonium is added from release by both juvenile and adult daphnia
ddammonium <- daph_a*a_exc_m + daph_j*j_exc_m -  ## need to fix excretion- not right
dalgae*dammonium*alpha*omega/(omega+dammonium) +
# ((dammonium*alpha*omega/(omega+dammonium)) / 10) * (death1*dalgae + death2*(dalgae^2)) -
gamma/2.5 * (death1*dalgae + death2*(dalgae^2)) -
# lagvalue(t - 5, 1) -
(1-amm_param_b)*dammonium
ddaph_j <- sat_fun(fec_a,fec_b,dalgae)*daph_a - daph_j*(35/70)
#daphnia adults are added from growth by juveniles and are lost from death
ddaph_a <- 1/(sat_fun(growth_a,growth_b,dalgae))*daph_j- daph_a*(1/death_b)
ddalgae <- beta * dalgae*dammonium*alpha*omega/(omega+dammonium) - death1*dalgae - death2*(dalgae^2)-
daph_a*a_feed_m*dalgae - daph_j*j_feed_m*dalgae
# return the rate of change
list(c(ddammonium, ddaph_j,ddaph_a,ddalgae))
}) # end with(as.list ...
}
out <- ode(y = state, times = seq(0,100,0.1), func = d_equations, parms = parameters)
plot(out)
d_equations <-function(t, state, parameters) {
with(as.list(c(state, parameters)),{
# rate of change
# ammonium is added from release by both juvenile and adult daphnia
ddammonium <- daph_a*a_exc_m + daph_j*j_exc_m -  ## need to fix excretion- not right
dalgae*dammonium*alpha*omega/(omega+dammonium) +
# ((dammonium*alpha*omega/(omega+dammonium)) / 10) * (death1*dalgae + death2*(dalgae^2)) -
gamma/2 * (death1*dalgae + death2*(dalgae^2)) -
# lagvalue(t - 5, 1) -
(1-amm_param_b)*dammonium
ddaph_j <- sat_fun(fec_a,fec_b,dalgae)*daph_a - daph_j*(35/70)
#daphnia adults are added from growth by juveniles and are lost from death
ddaph_a <- 1/(sat_fun(growth_a,growth_b,dalgae))*daph_j- daph_a*(1/death_b)
ddalgae <- beta * dalgae*dammonium*alpha*omega/(omega+dammonium) - death1*dalgae - death2*(dalgae^2)-
daph_a*a_feed_m*dalgae - daph_j*j_feed_m*dalgae
# return the rate of change
list(c(ddammonium, ddaph_j,ddaph_a,ddalgae))
}) # end with(as.list ...
}
out <- ode(y = state, times = seq(0,100,0.1), func = d_equations, parms = parameters)
plot(out)
tail(out)
out <- ode(y = state, times = seq(0,200,0.1), func = d_equations, parms = parameters)
plot(out)
tail(out)
d_equations <-function(t, state, parameters) {
with(as.list(c(state, parameters)),{
# rate of change
# ammonium is added from release by both juvenile and adult daphnia
ddammonium <- daph_a*a_exc_m + daph_j*j_exc_m -  ## need to fix excretion- not right
dalgae*dammonium*alpha*omega/(omega+dammonium) +
# ((dammonium*alpha*omega/(omega+dammonium)) / 10) * (death1*dalgae + death2*(dalgae^2)) -
gamma/2 * (death1*dalgae + death2*1.4*(dalgae^2)) -
# lagvalue(t - 5, 1) -
(1-amm_param_b)*dammonium
ddaph_j <- sat_fun(fec_a,fec_b,dalgae)*daph_a - daph_j*(35/70)
#daphnia adults are added from growth by juveniles and are lost from death
ddaph_a <- 1/(sat_fun(growth_a,growth_b,dalgae))*daph_j- daph_a*(1/death_b)
ddalgae <- beta * dalgae*dammonium*alpha*omega/(omega+dammonium) - death1*dalgae - death2*(dalgae^2)-
daph_a*a_feed_m*dalgae - daph_j*j_feed_m*dalgae
# return the rate of change
list(c(ddammonium, ddaph_j,ddaph_a,ddalgae))
}) # end with(as.list ...
}
out <- ode(y = state, times = seq(0,200,0.1), func = d_equations, parms = parameters)
plot(out)
tail(out)
d_equations <-function(t, state, parameters) {
with(as.list(c(state, parameters)),{
# rate of change
# ammonium is added from release by both juvenile and adult daphnia
ddammonium <- daph_a*a_exc_m + daph_j*j_exc_m -  ## need to fix excretion- not right
dalgae*dammonium*alpha*omega/(omega+dammonium) +
# ((dammonium*alpha*omega/(omega+dammonium)) / 10) * (death1*dalgae + death2*(dalgae^2)) -
gamma/2 * (death1*dalgae + death2*1.1*(dalgae^2)) -
# lagvalue(t - 5, 1) -
(1-amm_param_b)*dammonium
ddaph_j <- sat_fun(fec_a,fec_b,dalgae)*daph_a - daph_j*(35/70)
#daphnia adults are added from growth by juveniles and are lost from death
ddaph_a <- 1/(sat_fun(growth_a,growth_b,dalgae))*daph_j- daph_a*(1/death_b)
ddalgae <- beta * dalgae*dammonium*alpha*omega/(omega+dammonium) - death1*dalgae - death2*(dalgae^2)-
daph_a*a_feed_m*dalgae - daph_j*j_feed_m*dalgae
# return the rate of change
list(c(ddammonium, ddaph_j,ddaph_a,ddalgae))
}) # end with(as.list ...
}
out <- ode(y = state, times = seq(0,200,0.1), func = d_equations, parms = parameters)
plot(out)
tail(out)
d_equations <-function(t, state, parameters) {
with(as.list(c(state, parameters)),{
# rate of change
# ammonium is added from release by both juvenile and adult daphnia
ddammonium <- daph_a*a_exc_m + daph_j*j_exc_m -  ## need to fix excretion- not right
dalgae*dammonium*alpha*omega/(omega+dammonium) +
# ((dammonium*alpha*omega/(omega+dammonium)) / 10) * (death1*dalgae + death2*(dalgae^2)) -
gamma/2 * (death1*dalgae + death2*1.1*(dalgae^2)) -
# lagvalue(t - 5, 1) -
(1-amm_param_b)*dammonium
ddaph_j <- sat_fun(fec_a,fec_b,dalgae)*daph_a - daph_j*(35/70)
#daphnia adults are added from growth by juveniles and are lost from death
ddaph_a <- 1/(sat_fun(growth_a,growth_b,dalgae))*daph_j- daph_a*(1/death_b)
ddalgae <- beta * dalgae*dammonium*alpha*omega/(omega+dammonium) - death1*dalgae - death2*1.1*(dalgae^2)-
daph_a*a_feed_m*dalgae - daph_j*j_feed_m*dalgae
# return the rate of change
list(c(ddammonium, ddaph_j,ddaph_a,ddalgae))
}) # end with(as.list ...
}
out <- ode(y = state, times = seq(0,200,0.1), func = d_equations, parms = parameters)
plot(out)
tail(out)
d_equations <-function(t, state, parameters) {
with(as.list(c(state, parameters)),{
# rate of change
# ammonium is added from release by both juvenile and adult daphnia
ddammonium <- daph_a*a_exc_m + daph_j*j_exc_m -  ## need to fix excretion- not right
dalgae*dammonium*alpha*omega/(omega+dammonium) +
# ((dammonium*alpha*omega/(omega+dammonium)) / 10) * (death1*dalgae + death2*(dalgae^2)) -
gamma/2 * (death1*dalgae + death2*2.1*(dalgae^2)) -
# lagvalue(t - 5, 1) -
(1-amm_param_b)*dammonium
ddaph_j <- sat_fun(fec_a,fec_b,dalgae)*daph_a - daph_j*(35/70)
#daphnia adults are added from growth by juveniles and are lost from death
ddaph_a <- 1/(sat_fun(growth_a,growth_b,dalgae))*daph_j- daph_a*(1/death_b)
ddalgae <- beta * dalgae*dammonium*alpha*omega/(omega+dammonium) - death1*dalgae - death2*2.1*(dalgae^2)-
daph_a*a_feed_m*dalgae - daph_j*j_feed_m*dalgae
# return the rate of change
list(c(ddammonium, ddaph_j,ddaph_a,ddalgae))
}) # end with(as.list ...
}
out <- ode(y = state, times = seq(0,200,0.1), func = d_equations, parms = parameters)
plot(out)
tail(out)
d_equations <-function(t, state, parameters) {
with(as.list(c(state, parameters)),{
# rate of change
# ammonium is added from release by both juvenile and adult daphnia
ddammonium <- daph_a*a_exc_m + daph_j*j_exc_m -  ## need to fix excretion- not right
dalgae*dammonium*alpha*omega/(omega+dammonium) +
# ((dammonium*alpha*omega/(omega+dammonium)) / 10) * (death1*dalgae + death2*(dalgae^2)) -
gamma/2 * (death1*dalgae + death2*(dalgae^2)) -
# lagvalue(t - 5, 1) -
(1-amm_param_b)*dammonium
ddaph_j <- sat_fun(fec_a,fec_b,dalgae)*daph_a - daph_j*(35/70)
#daphnia adults are added from growth by juveniles and are lost from death
ddaph_a <- 1/(sat_fun(growth_a,growth_b,dalgae))*daph_j- daph_a*(1/death_b)
ddalgae <- beta * dalgae*dammonium*alpha*omega/(omega+dammonium) - death1*dalgae - death2*(dalgae^2)-
daph_a*a_feed_m*dalgae - daph_j*j_feed_m*dalgae
# return the rate of change
list(c(ddammonium, ddaph_j,ddaph_a,ddalgae))
}) # end with(as.list ...
}
out <- ode(y = state, times = seq(0,200,0.1), func = d_equations, parms = parameters)
plot(out)
tail(out)
d_equations <-function(t, state, parameters) {
with(as.list(c(state, parameters)),{
# rate of change
# ammonium is added from release by both juvenile and adult daphnia
ddammonium <- daph_a*a_exc_m + daph_j*j_exc_m -  ## need to fix excretion- not right
dalgae*dammonium*alpha*omega/(omega+dammonium) +
# ((dammonium*alpha*omega/(omega+dammonium)) / 10) * (death1*dalgae + death2*(dalgae^2)) -
gamma/2.5 * (death1*dalgae + death2*(dalgae^2)) -
# lagvalue(t - 5, 1) -
(1-amm_param_b)*dammonium
ddaph_j <- sat_fun(fec_a,fec_b,dalgae)*daph_a - daph_j*(35/70)
#daphnia adults are added from growth by juveniles and are lost from death
ddaph_a <- 1/(sat_fun(growth_a,growth_b,dalgae))*daph_j- daph_a*(1/death_b)
ddalgae <- beta * dalgae*dammonium*alpha*omega/(omega+dammonium) - death1*dalgae - death2*(dalgae^2)-
daph_a*a_feed_m*dalgae - daph_j*j_feed_m*dalgae
# return the rate of change
list(c(ddammonium, ddaph_j,ddaph_a,ddalgae))
}) # end with(as.list ...
}
out <- ode(y = state, times = seq(0,200,0.1), func = d_equations, parms = parameters)
plot(out)
tail(out)
