pop$TankNum[i] == 45| pop$TankNum[i] ==51| pop$TankNum[i] ==63|
pop$TankNum[i] ==70| pop$TankNum[i] ==71| pop$TankNum[i] ==89|
pop$TankNum[i] ==105| pop$TankNum[i] ==133|pop$TankNum[i] ==135){
pop$treatment[i] <- 1
} else if (pop$TankNum[i] == 14|pop$TankNum[i] ==25|pop$TankNum[i] ==31|
pop$TankNum[i] ==62| pop$TankNum[i] ==94| pop$TankNum[i] ==110|
pop$TankNum[i] ==112| pop$TankNum[i] ==125){
pop$treatment[i] <- 2
} else if (pop$TankNum[i] ==1|pop$TankNum[i] ==8|pop$TankNum[i] ==13|
pop$TankNum[i] ==55|pop$TankNum[i] ==58|pop$TankNum[i] ==66|
pop$TankNum[i] ==82|pop$TankNum[i] ==99|pop$TankNum[i] ==104|
pop$TankNum[i] ==130|pop$TankNum[i] ==138
){
pop$treatment[i] <- 3
} else if (pop$TankNum[i] == 6|pop$TankNum[i] ==29|pop$TankNum[i] ==30|
pop$TankNum[i] ==50|pop$TankNum[i] ==81|pop$TankNum[i] ==93|
pop$TankNum[i] ==111|pop$TankNum[i] ==117|pop$TankNum[i] ==126
) {
pop$treatment[i] <- 4
} else if (pop$TankNum[i] ==7|pop$TankNum[i] ==32|pop$TankNum[i] ==36|
pop$TankNum[i] ==46|pop$TankNum[i] ==49|pop$TankNum[i] ==73|
pop$TankNum[i] ==88|pop$TankNum[i] ==97|pop$TankNum[i] ==107|
pop$TankNum[i] ==119|pop$TankNum[i] ==120|pop$TankNum[i] ==137){
pop$treatment[i] <- 5
} else if (pop$TankNum[i] ==11|pop$TankNum[i] ==22|pop$TankNum[i] ==35|pop$TankNum[i] ==57|
pop$TankNum[i] ==69|pop$TankNum[i] ==79|pop$TankNum[i] ==96|pop$TankNum[i] ==123){
pop$treatment[i] <- 6
} else if (pop$TankNum[i] ==18|pop$TankNum[i] ==24|pop$TankNum[i] ==34|pop$TankNum[i] ==59|
pop$TankNum[i] ==64|pop$TankNum[i] ==86|pop$TankNum[i] ==91|pop$TankNum[i] ==102|
pop$TankNum[i] ==115|pop$TankNum[i] ==122|pop$TankNum[i] ==132|pop$TankNum[i]==139){
pop$treatment[i] <- 7
} else if (pop$TankNum[i] ==15|pop$TankNum[i] ==39|pop$TankNum[i] ==40|pop$TankNum[i] ==76|
pop$TankNum[i] ==77|pop$TankNum[i] ==85|pop$TankNum[i] ==103|pop$TankNum[i] ==129){
pop$treatment[i] <- 8
} else if (pop$TankNum[i] ==21|pop$TankNum[i] ==27|pop$TankNum[i] ==33|
pop$TankNum[i] ==47|pop$TankNum[i] ==52|pop$TankNum[i] ==72|
pop$TankNum[i] ==75|pop$TankNum[i] ==100|pop$TankNum[i] ==101|
pop$TankNum[i] ==106|pop$TankNum[i] ==118|pop$TankNum[i] ==131|pop$TankNum[i] ==140){
pop$treatment[i] <- 9
} else if (pop$TankNum[i] ==12|pop$TankNum[i] ==38|pop$TankNum[i] ==54|
pop$TankNum[i] ==68|pop$TankNum[i] ==74|pop$TankNum[i] ==92|
pop$TankNum[i] ==136){
pop$treatment[i] <- 10
} else if (pop$TankNum[i] ==5|pop$TankNum[i] ==10|pop$TankNum[i] ==23|
pop$TankNum[i] ==44|pop$TankNum[i] ==78|pop$TankNum[i] ==83|
pop$TankNum[i] ==84|pop$TankNum[i] ==87|pop$TankNum[i] ==114|
pop$TankNum[i] ==121|pop$TankNum[i] ==127){
pop$treatment[i] <- 11
} else if (pop$TankNum[i] ==9|pop$TankNum[i] ==28|pop$TankNum[i] ==37|
pop$TankNum[i] ==56|pop$TankNum[i] ==67|pop$TankNum[i] ==90|
pop$TankNum[i] ==113|pop$TankNum[i] ==116|pop$TankNum[i] == 128) {
pop$treatment[i] <- 12
} else if (pop$TankNum[i] == 3|pop$TankNum[i] ==17|pop$TankNum[i] ==42|
pop$TankNum[i] ==43|pop$TankNum[i] ==60|pop$TankNum[i] ==61|
pop$TankNum[i] ==80|pop$TankNum[i] ==95|pop$TankNum[i] ==98|
pop$TankNum[i] ==108){
pop$treatment[i] <- 13
} else if (pop$TankNum[i] ==2|pop$TankNum[i] ==4|pop$TankNum[i] ==16|
pop$TankNum[i] ==20|pop$TankNum[i] ==48|pop$TankNum[i] ==53|pop$TankNum[i] ==65|
pop$TankNum[i] ==109|pop$TankNum[i] ==124|pop$TankNum[i] == 134){
pop$treatment[i] <- 14
}
}
dat1 = dat %>% filter(treatment == 1)
date<- dat1 %>% unite("date", Day:Month, sep = "_", remove = TRUE)
dat1$date <- date$date
broke <- dat1 %>% filter(is.na(Chl))  ## February 11 and 12
dat2 <- dat1 %>% filter(Month == "January")  ## all looks good
ggplot(dat2, aes(date,Chl)) + geom_point()
dat3 <- dat1 %>% filter(Month == "February") %>% filter(Day < 12)
ggplot(dat3, aes(date,Chl)) + geom_point() ## the 10th is clearly bad
ggplot(dat3[dat3$Chl< 1000,], aes(date,Chl)) + geom_point() ## 9th might be ok but huge jump so to make sure will remove it
ggplot(dat3, aes(date,Chl)) + geom_point() ## the 10th is clearly bad
ggplot(dat3, aes(date,Chl)) + geom_point() ## 9th might be ok but huge jump so to make sure will remove it
## correct for blank flourimeter readings
blank <- read.csv("Blank_algae.csv")
str(blank)
newdat <- left_join(dat1, blank, by= Date)
str(dat1)
separate(blank, Date, c("Day", "Month"), sep = " ")
blank <- separate(blank, Date, c("Month", "Day"), sep = " ")
str(blank)
newdat <- left_join(dat1, blank, by= c(Month, Day))
newdat <- left_join(dat1, blank)
blank$Day <- as.numeric(as.character(blank$Day))
newdat <- left_join(dat1, blank)
str(newdat)
newdat$adj_chl <- newdat$Chl - newdat$Blank.Chl
newdat$Blank.Chl[is.na(newdat$Blank.Chl)] <- 0
newdat$adj_chl <- newdat$Chl - newdat$Blank.Chl
newdat$adj_chl
nrow(newdat)
newdat <- newdat %>% filter(date != "9_February"& date != "10_February" & date != "11_February" &
date != "12_February" )
nrow(newdat)
knitr::opts_chunk$set(echo = TRUE)
library(deSolve)
library(here)
state <- c(
ammonium = 10,
daph_j = 0,
daph_a = 20,
algae  = 20
)
param <- read.csv(here("RDS_compiled/parameters_no_cerio.csv"))
parameters <- c(
alpha = 0.2339,    #mg N/(ug chl*day)
kappa = 0.639,  # 0.2153469,    #mg N
e =  12,               #ug chl/mgN
death1 = 2.4,         # 1/day
fa = median(param$a_feed_m),       # ug chl/(daphniaA*day)
fj = median(param$j_feed_m),       # ug chl/(daphniaj*day)
rho = 0.0785709,                    # mg N/ chl
camm = 1- median(param$amm_param_b),     # 1/day
xa = median(param$a_exc_m),       # mg N/ (daphniaA*day)
xj= median(param$j_exc_m),        # mg N/ (daphniaJ*day)
g1 =median(param$growth_a),        # daphniaD/(daphniaJ*day)
g2=median(param$growth_b),         # ug chl
#g1 = 1/4.8,
death2 = 1/median(param$death_b),   # 1/day
b1 = median(param$fec_a),       # daphniaJ/(daphniaD*day)
b2 = median(param$fec_b),        # ug chl
death3 = 1/median(param$death_b)  # 1/day
)
full_equations <-function(t, state, parameters) {
with(as.list(c(state, parameters)),{
# ammonium is added from release by both juvenile and adult daphnia  and lost through algal update and nitritfication
dammonium <- -(alpha*ammonium)/(kappa+ammonium)*algae + rho*death1*algae - camm*ammonium + daph_a*xa + daph_j*xa/10
#juvenile daphia are added by density dependent (large daphnia) birth
ddaph_j <- daph_a*(b1*algae)/(b2+algae) - daph_j*death3*10
#daphnia adults are added from growth by juveniles and are lost from death
ddaph_a <- - daph_a*death3 +(g1*algae)/(g2+algae)  #+daph_j*g1
# algae is added from growth based on uptake of ammonium
dalgae <- (alpha*ammonium)/(kappa+ammonium)*algae*e - death1*algae- daph_a*fa - daph_j*fj
# return the rate of change
list(c(dammonium, ddaph_j,ddaph_a,dalgae))
})
}
m
out_med <- ode(y = state, times = seq(0,42,0.1), func = full_equations, parms = parameters)
plot(out_med)
predmed <- as.data.frame(out_med)
predmed$quantile <- "med"
dat_daph <- newdat %>% filter(treatment == 3) %>% filter(NH4 < 20)%>%
select(TankNum, NH4, Chl,Day)
names(dat_daph) <- c("TankNum", "ammonium","algae","time")
amm_g <- ggplot(predmed, aes(time,ammonium)) + geom_line(linetype = "solid")+
#geom_line(data= predup, linetype = "dotdash") +
geom_line(data=pred, linetype ="dotdash")+
theme_bw()+ geom_point(data = dat_daph,aes(time,ammonium) )+
ylab("Ammonium mg/L")+xlab("Days")+
theme(axis.text.x = element_text(size = 30),
axis.text.y = element_text(size = 32),
axis.title.x = element_text(size = 30),
axis.title.y = element_text(size = 32),
strip.text = element_text(size = 0),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_blank())
g
amm_g <- ggplot(predmed, aes(time,ammonium)) + geom_line(linetype = "solid")+
#geom_line(data= predup, linetype = "dotdash") +
#geom_line(data=pred, linetype ="dotdash")+
theme_bw()+ geom_point(data = dat_daph,aes(time,ammonium) )+
ylab("Ammonium mg/L")+xlab("Days")+
theme(axis.text.x = element_text(size = 30),
axis.text.y = element_text(size = 32),
axis.title.x = element_text(size = 30),
axis.title.y = element_text(size = 32),
strip.text = element_text(size = 0),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_blank())
amm_g
str(dat_daph)
str(newdat)
dat_daph <- newdat %>% filter(treatment == 3) %>% filter(NH4 < 20) #%>%
str(dat_daph)
newdat %>% filter(treatment == 3)
newdat %>% filter(treatment == 1)
unique(newdat$TankNum)
dat1 = dat %>% filter(treatment == 1)
date<- dat1 %>% unite("date", Day:Month, sep = "_", remove = TRUE)
dat1$date <- date$date
broke <- dat1 %>% filter(is.na(Chl))  ## February 11 and 12
## correct for blank flourimeter readings
blank <- read.csv("Blank_algae.csv")
blank <- separate(blank, Date, c("Month", "Day"), sep = " ")
blank$Day <- as.numeric(as.character(blank$Day))
newdat <- left_join(broke, blank)
newdat$Blank.Chl[is.na(newdat$Blank.Chl)] <- 0
newdat
unique(newdat$treatment)
str(dat)
newdat <- left_join(dat, blank)
unique(newdat$treatment)
newdat$Blank.Chl[is.na(newdat$Blank.Chl)] <- 0
newdat$adj_chl <- newdat$Chl - newdat$Blank.Chl
newdat <- newdat %>% filter(date != "9_February"& date != "10_February" & date != "11_February" &
date != "12_February" )
newdat$Day
str(newdat)
newdat <- newdat %>% filter(Month != "February"& Day != 9)
newdat
unique(newdat$Month)
newdat <- newdat %>% filter(Month != "February"& Day != 9) %>% filter(Month != "February"& Day != 10) %>%
filter(Month != "February"& Day != 11) %>% filter(Month != "February"& Day != 12)
dat_daph <- newdat %>% filter(treatment == 3) %>% filter(NH4 < 20)
names(dat_daph) <- c("TankNum", "ammonium","algae","time")
amm_g <- ggplot(predmed, aes(time,ammonium)) + geom_line(linetype = "solid") +
#geom_line(data= predup, linetype = "dotdash") +
#geom_line(data=pred, linetype ="dotdash")+
theme_bw()+ geom_point(data = dat_daph,aes(time,ammonium) )+
ylab("Ammonium mg/L")+xlab("Days")+
theme(axis.text.x = element_text(size = 30),
axis.text.y = element_text(size = 32),
axis.title.x = element_text(size = 30),
axis.title.y = element_text(size = 32),
strip.text = element_text(size = 0),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_blank())
amm_g
str(dat_daph)
dat_daph <- newdat %>% filter(treatment == 3) %>% filter(NH4 < 20)%>%
select(TankNum, NH4, Chl,Day)
names(dat_daph) <- c("TankNum", "ammonium","algae","time")
amm_g <- ggplot(predmed, aes(time,ammonium)) + geom_line(linetype = "solid") +
#geom_line(data= predup, linetype = "dotdash") +
#geom_line(data=pred, linetype ="dotdash")+
theme_bw()+ geom_point(data = dat_daph,aes(time,ammonium) )+
ylab("Ammonium mg/L")+xlab("Days")+
theme(axis.text.x = element_text(size = 30),
axis.text.y = element_text(size = 32),
axis.title.x = element_text(size = 30),
axis.title.y = element_text(size = 32),
strip.text = element_text(size = 0),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_blank())
amm_g
alg_g <- ggplot(predmed, aes(time,algae)) + geom_line(linetype = "solid")+
geom_line(data= predup, linetype = "dotdash") + geom_line(data=pred, linetype ="dotdash")+
theme_bw()+ geom_point(data = dat_daph,aes(time,algae) )+
ylab("Chl a ug/L")+xlab("Days")+
theme(axis.text.x = element_text(size = 30),
axis.text.y = element_text(size = 32),
axis.title.x = element_text(size = 30),
axis.title.y = element_text(size = 32),
strip.text = element_text(size = 0),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_blank())
alg_g <- ggplot(predmed, aes(time,algae)) + geom_line(linetype = "solid")+
#geom_line(data= predup, linetype = "dotdash") + geom_line(data=pred, linetype ="dotdash")+
theme_bw()+ geom_point(data = dat_daph,aes(time,algae) )+
ylab("Chl a ug/L")+xlab("Days")+
theme(axis.text.x = element_text(size = 30),
axis.text.y = element_text(size = 32),
axis.title.x = element_text(size = 30),
axis.title.y = element_text(size = 32),
strip.text = element_text(size = 0),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_blank())
alg_g
dat_daph <- newdat %>% filter(treatment == 3) %>% #filter(NH4 < 20)%>%
select(TankNum, NH4, Chl,Day)
names(dat_daph) <- c("TankNum", "ammonium","algae","time")
amm_g <- ggplot(predmed, aes(time,ammonium)) + geom_line(linetype = "solid") +
#geom_line(data= predup, linetype = "dotdash") +
#geom_line(data=pred, linetype ="dotdash")+
theme_bw()+ geom_point(data = dat_daph,aes(time,ammonium) )+
ylab("Ammonium mg/L")+xlab("Days")+
theme(axis.text.x = element_text(size = 30),
axis.text.y = element_text(size = 32),
axis.title.x = element_text(size = 30),
axis.title.y = element_text(size = 32),
strip.text = element_text(size = 0),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_blank())
alg_g <- ggplot(predmed, aes(time,algae)) + geom_line(linetype = "solid")+
#geom_line(data= predup, linetype = "dotdash") + geom_line(data=pred, linetype ="dotdash")+
theme_bw()+ geom_point(data = dat_daph,aes(time,algae) )+
ylab("Chl a ug/L")+xlab("Days")+
theme(axis.text.x = element_text(size = 30),
axis.text.y = element_text(size = 32),
axis.title.x = element_text(size = 30),
axis.title.y = element_text(size = 32),
strip.text = element_text(size = 0),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_blank())
amm_g
amm_g <- ggplot(predmed, aes(time,ammonium)) + geom_line(linetype = "solid") +
#geom_line(data= predup, linetype = "dotdash") +
#geom_line(data=pred, linetype ="dotdash")+
theme_bw()+ geom_point(data = dat_daph,aes(time,ammonium) )+
ylab("Ammonium mg/L")+xlab("Days")+
theme(axis.text.x = element_text(size = 30),
axis.text.y = element_text(size = 32),
axis.title.x = element_text(size = 30),
axis.title.y = element_text(size = 32),
strip.text = element_text(size = 0),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_blank())
amm_g
dat_daph <- newdat %>% filter(treatment == 3) %>% filter(NH4 < 20)%>%  # the filter remves 3 points at 60 which have to be wrong...all on the same day
select(TankNum, NH4, Chl,Day)
amm_g <- ggplot(predmed, aes(time,ammonium)) + geom_line(linetype = "solid") +
#geom_line(data= predup, linetype = "dotdash") +
#geom_line(data=pred, linetype ="dotdash")+
theme_bw()+ geom_point(data = dat_daph,aes(time,ammonium) )+
ylab("Ammonium mg/L")+xlab("Days")+
theme(axis.text.x = element_text(size = 30),
axis.text.y = element_text(size = 32),
axis.title.x = element_text(size = 30),
axis.title.y = element_text(size = 32),
strip.text = element_text(size = 0),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_blank())
amm_g
# the filter remves 3 points at 60 which have to be wrong...all on the same day
dat_daph <- newdat %>% filter(treatment == 3) %>% filter(NH4 < 20)%>%
dplyr::select(TankNum, NH4, Chl,Day)
names(dat_daph) <- c("TankNum", "ammonium","algae","time")
amm_g <- ggplot(predmed, aes(time,ammonium)) + geom_line(linetype = "solid") +
#geom_line(data= predup, linetype = "dotdash") +
#geom_line(data=pred, linetype ="dotdash")+
theme_bw()+ geom_point(data = dat_daph,aes(time,ammonium) )+
ylab("Ammonium mg/L")+xlab("Days")+
theme(axis.text.x = element_text(size = 30),
axis.text.y = element_text(size = 32),
axis.title.x = element_text(size = 30),
axis.title.y = element_text(size = 32),
strip.text = element_text(size = 0),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_blank())
amm_g
knitr::opts_chunk$set(echo = TRUE)
library(deSolve)
library(here)
state <- c(
ammonium = 10,
daph_j = 0,
daph_a = 20,
algae  = 20
)
param <- read.csv(here("RDS_compiled/parameters_no_cerio.csv"))
parameters <- c(
alpha = 0.2339,    #mg N/(ug chl*day)
kappa = 0.639,  # 0.2153469,    #mg N
e =  12,               #ug chl/mgN
death1 = 2.4,         # 1/day
fa = median(param$a_feed_m),       # ug chl/(daphniaA*day)
fj = median(param$j_feed_m),       # ug chl/(daphniaj*day)
rho = 0.0785709,                    # mg N/ chl
camm = 1- median(param$amm_param_b),     # 1/day
xa = median(param$a_exc_m),       # mg N/ (daphniaA*day)
xj= median(param$j_exc_m),        # mg N/ (daphniaJ*day)
g1 =median(param$growth_a),        # daphniaD/(daphniaJ*day)
g2=median(param$growth_b),         # ug chl
#g1 = 1/4.8,
death2 = 1/median(param$death_b),   # 1/day
b1 = median(param$fec_a),       # daphniaJ/(daphniaD*day)
b2 = median(param$fec_b),        # ug chl
death3 = 1/median(param$death_b)  # 1/day
)
eventdat <- data.frame(var = c("ammonium"),
time = c(21) ,
value = c(2),
method = c("multiply"))
full_equations <-function(t, state, parameters) {
with(as.list(c(state, parameters)),{
dammonium <- -(alpha*ammonium)/(kappa+ammonium)*algae + rho*death1*algae - camm*ammonium + daph_a*xa + daph_j*xa/10
ddaph_j <- daph_a*(b1*algae)/(b2+algae) - daph_j*death3*10
ddaph_a <- - daph_a*death3 +(g1*algae)/(g2+algae)
dalgae <- (alpha*ammonium)/(kappa+ammonium)*algae*e - death1*algae- daph_a*fa - daph_j*fj
# return the rate of change
list(c(dammonium, ddaph_j,ddaph_a,dalgae))
})
}
out_med <- ode(y = state, times = seq(0,42,0.1), func = full_equations, parms = parameters,
events = list(data = eventdat))
predmed <- as.data.frame(out_med)
predmed$quantile <- "med"
dat_daph <- dat %>% filter(treatment == 4) %>% #filter(NH4 < 20)%>%
dplyr:: select(TankNum, NH4, Chl,Day)
names(dat_daph) <- c("TankNum", "ammonium","algae","time")
amm_g <- ggplot(predmed, aes(time,ammonium)) + geom_line(linetype = "solid")+
#geom_line(data= predup, linetype = "dotdash") +
#geom_line(data=pred, linetype ="dotdash")+
theme_bw()+ geom_point(data = dat_daph,aes(time,ammonium) )+
ylab("Ammonium mg/L")+xlab("Days")+
theme(axis.text.x = element_text(size = 30),
axis.text.y = element_text(size = 32),
axis.title.x = element_text(size = 30),
axis.title.y = element_text(size = 32),
strip.text = element_text(size = 0),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_blank())
amm_g
dat_daph <- dat %>% filter(treatment == 4) %>% filter(NH4 < 20)%>%
dplyr:: select(TankNum, NH4, Chl,Day)
names(dat_daph) <- c("TankNum", "ammonium","algae","time")
amm_g <- ggplot(predmed, aes(time,ammonium)) + geom_line(linetype = "solid")+
#geom_line(data= predup, linetype = "dotdash") +
#geom_line(data=pred, linetype ="dotdash")+
theme_bw()+ geom_point(data = dat_daph,aes(time,ammonium) )+
ylab("Ammonium mg/L")+xlab("Days")+
theme(axis.text.x = element_text(size = 30),
axis.text.y = element_text(size = 32),
axis.title.x = element_text(size = 30),
axis.title.y = element_text(size = 32),
strip.text = element_text(size = 0),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_blank())
amm_g
alg_g <- ggplot(predmed, aes(time,algae)) + geom_line(linetype = "solid")+
# geom_line(data= predup, linetype = "dotdash") + geom_line(data=pred, linetype ="dotdash")+
theme_bw()+ geom_point(data = dat_daph,aes(time,algae) )+
ylab("Chl a ug/L")+xlab("Days")+
theme(axis.text.x = element_text(size = 30),
axis.text.y = element_text(size = 32),
axis.title.x = element_text(size = 30),
axis.title.y = element_text(size = 32),
strip.text = element_text(size = 0),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_blank())
alg_g
unique(dat_daph$time)
max(dat_daph$time)
str(pop)
source("pop_curves.R")
str(popA)
adult <- popA %>% filter(treatment == 3)
str(adult)
1/.01
adult <- popA %>% filter(treatment == 3) %>% group_by(TankNum,ExptDay) %>%
summarize(pop_mean = mean(count)*(Liters/.01))
adult <- popA %>% filter(treatment == 3) %>% group_by(TankNum,ExptDay) %>%
summarize(pop_mean = mean(count)*(mean(Liters)/.01))
adult
str(popJ)
juv <- popJ %>% filter(treatment == 3) %>% group_by(TankNum,ExptDay) %>%
summarize(pop_mean = mean(count)*(mean(Liters)/.01))
str(predmed)
str(adult)
adult <- popA %>% filter(treatment == 3) %>% group_by(TankNum,ExptDay) %>%
summarize(pop_mean = mean(count)*(mean(Liters)/.01)) %>% dplyr::select(TankNum, ExptDay, pop_mean)
names(adult) <- c("TankNum", "time","daph_a")
juv
ad_graph <- ggplot(predmed, aes(time,daph_a)) + geom_line(linetype = "solid")+
#geom_line(data= predup, linetype = "dotdash") + geom_line(data=pred, linetype ="dotdash")+
theme_bw()+ geom_point(data = adult,aes(time,algae) )+
ylab("Chl a ug/L")+xlab("Days")+
theme(axis.text.x = element_text(size = 30),
axis.text.y = element_text(size = 32),
axis.title.x = element_text(size = 30),
axis.title.y = element_text(size = 32),
strip.text = element_text(size = 0),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_blank())
ad_graph
ad_graph <- ggplot(predmed, aes(time,daph_a)) + geom_line(linetype = "solid")+
#geom_line(data= predup, linetype = "dotdash") + geom_line(data=pred, linetype ="dotdash")+
theme_bw()+ geom_point(data = adult,aes(time,daph_a) )+
ylab("Adult Daphnia")+xlab("Days")+
theme(axis.text.x = element_text(size = 30),
axis.text.y = element_text(size = 32),
axis.title.x = element_text(size = 30),
axis.title.y = element_text(size = 32),
strip.text = element_text(size = 0),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_blank())
ad_graph
juv_graph <- ggplot(predmed, aes(time,daph_j)) + geom_line(linetype = "solid")+
#geom_line(data= predup, linetype = "dotdash") + geom_line(data=pred, linetype ="dotdash")+
theme_bw()+ geom_point(data = juv,aes(time,daph_j) )+
ylab("Adult Daphnia")+xlab("Days")+
theme(axis.text.x = element_text(size = 30),
axis.text.y = element_text(size = 32),
axis.title.x = element_text(size = 30),
axis.title.y = element_text(size = 32),
strip.text = element_text(size = 0),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_blank())
juv_graph
names(juv) <- c("TankNum","time","daph_j")
juv_graph <- ggplot(predmed, aes(time,daph_j)) + geom_line(linetype = "solid")+
#geom_line(data= predup, linetype = "dotdash") + geom_line(data=pred, linetype ="dotdash")+
theme_bw()+ geom_point(data = juv,aes(time,daph_j) )+
ylab("Adult Daphnia")+xlab("Days")+
theme(axis.text.x = element_text(size = 30),
axis.text.y = element_text(size = 32),
axis.title.x = element_text(size = 30),
axis.title.y = element_text(size = 32),
strip.text = element_text(size = 0),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_blank())
juv_graph
