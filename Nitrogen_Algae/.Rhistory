chl <- chl9_all %>% filter(loglik != "NA") %>% filter(loglik > -432)
chl1 <- chl %>% filter(corrgood == 1)
nrow(chl1)
head(chl1)
med_param_9 <- chl1 %>%
gather(key = "parameter", value = "value", -c(ttime,loglik,corrgood,X)) %>%
select (-c(ttime,loglik,corrgood,X)) %>%
summary(parm_med = median())
med_param_9
med_param_9 <- chl1 %>%
gather(key = "parameter", value = "value", -c(ttime,loglik,corrgood,X)) %>%
select (-c(ttime,loglik,corrgood,X)) %>%
group_by(parameter)
med_param_9
head(chl1)
med_param_9 <- chl1 %>%
gather(key = "parameter", value = "value", -c(ttime,loglik,corrgood,X)) %>%
select (-c(ttime,loglik,corrgood,X))  #%>%
head(med_param_9)
tail(med_param_9)
med_param_9 <- chl1 %>%
gather(key = "parameter", value = "value", -c(ttime,loglik,corrgood,X)) %>%
group_by(parameter)
med_param_9
med_param_9 <- chl1 %>%
gather(key = "parameter", value = "value", -c(ttime,loglik,corrgood,X)) %>%
select (-c(ttime,loglik,corrgood,X)) # %>%
med_param_9 %>% group_by(parameter)
med_param_9 <- chl1 %>%
gather(key = "parameter", value = "value", -c(ttime,loglik,corrgood,X)) %>%
select (-c(ttime,loglik,corrgood,X))  %>%
group_by(parameter) %>%
summarize(parmmed = median())
med_param_9 <- chl1 %>%
gather(key = "parameter", value = "value", -c(ttime,loglik,corrgood,X)) %>%
select (-c(ttime,loglik,corrgood,X))  %>%
group_by(parameter) %>%
summarize(parmmed = median(value))
med_param_9
?fitode
?optim
newstart <- setNames(med_param_9$parmmed, as.character(med_param_9$parmeter))
newstart <- setNames(med_param_9$parmmed, as.character(med_param_9$parameter))
newstart
chl_nh4_mod <- new("model.ode",
name = "algal_nit",
model = list(
pred_nh4 ~ -pred_chl*pred_nh4*alpha*omega/(omega+pred_nh4) + gamma *(death1*pred_chl + death2*(pred_chl^2))-cammonium*pred_nh4 ,
pred_chl ~ beta * pred_chl*pred_nh4*alpha*omega/(omega+pred_nh4) - death1*pred_chl - death2*(pred_chl^2)
),
## consider using bbmle::dnorm_n ?
observation = list(
nh4 ~ dnorm2(mean = pred_nh4),
chl ~ dnorm2(mean = pred_chl)
),
initial = list(pred_nh4 ~ pred_nh40 , pred_chl ~ pred_chl0),
par=c("alpha", "beta", "omega", "death1","death2", "pred_nh40", "pred_chl0", "gamma")
)
ss <- ode.solve(chl_nh4_mod, 1:11, start=newstart,
solver.opts=list(method="rk4", hini=0.1))
library("fitode")
ss <- ode.solve(chl_nh4_mod, 1:11, start=newstart,
solver.opts=list(method="rk4", hini=0.1))
ss <- ode.solve(chl_nh4_mod, 1:11, start,
solver.opts=list(method="rk4", hini=0.1))
?ode.solve
ss <- ode.solve(chl_nh4_mod, 1:11, newstart,
solver.opts=list(method="rk4", hini=0.1))
plot(dat_nit_9$date1, dat_nit_9$nh4, ylim=c(0, 30))
lines(ss@solution$pred_nh4)
plot(dat_nit_9$date1, dat_nit_9$chl)
lines(ss@solution$pred_chl)
newstart
newstart[[8]] <- 6
ss <- ode.solve(chl_nh4_mod, 1:11, newstart,
solver.opts=list(method="rk4", hini=0.1))
plot(dat_nit_9$date1, dat_nit_9$nh4, ylim=c(0, 30))
lines(ss@solution$pred_nh4)
plot(dat_nit_9$date1, dat_nit_9$chl)
lines(ss@solution$pred_chl)
newstart[[7]] <- 40
ss <- ode.solve(chl_nh4_mod, 1:11, newstart,
solver.opts=list(method="rk4", hini=0.1))
plot(dat_nit_9$date1, dat_nit_9$nh4, ylim=c(0, 30))
lines(ss@solution$pred_nh4)
plot(dat_nit_9$date1, dat_nit_9$chl)
lines(ss@solution$pred_chl)
chl1
chl
min(chl$pred_nh40)
max(chl$pred_nh40)
newstart[[8]] <- 8
newstart[[7]] <- 40
ss <- ode.solve(chl_nh4_mod, 1:11, newstart,
solver.opts=list(method="rk4", hini=0.1))
plot(dat_nit_9$date1, dat_nit_9$nh4, ylim=c(0, 30))
lines(ss@solution$pred_nh4)
plot(dat_nit_9$date1, dat_nit_9$chl)
lines(ss@solution$pred_chl)
## maybe figure out initial values
start <- c(alpha = 0.03,
beta = 15,
omega=2.3,
death1=0.006,
death2=0.001,
pred_nh40 = 15 ,
pred_chl0 = 40,
gamma=0.01
)
chl_fit_27_dd <- fitode(
chl_nh4_mod,
data = dat_nit_27,
start=start,
tcol = "date1",
solver.opts=list(method="rk4", hini=0.1)
)
coef(chl_fit_27_dd)
5.577709e-03 *.3
5.577709e-03 - (5.577709e-03*.3)
5.577709e-03 + (5.577709e-03*.3)
1.626124e+01- (1.626124e+01*.3)
1.626124e+01+ (1.626124e+01*.3)
1.401032e+01-(1.401032e+01*.3)
1.401032e+01+(1.401032e+01*.3)
2.954388e-03-(2.954388e-03*.3)
2.954388e-03+(2.954388e-03*.3)
6.663002e-04 - (6.663002e-04*.3)
6.663002e-04 + (6.663002e-04*.3)
plot(chl_fit_27_dd, level=0.95)
9.698845e-02 -(9.698845e-02 *.3)
9.698845e-02 +(9.698845e-02 *.3)
cammonium = 0.04085 # proportional ammonium lost to env-- calc in nutrient_air.R
chl_nh4_mod <- new("model.ode",
name = "algal_nit",
model = list(
pred_nh4 ~ -pred_chl*pred_nh4*alpha*omega/(omega+pred_nh4) + gamma *(death1*pred_chl + death2*(pred_chl^2))-cammonium*pred_nh4 ,
pred_chl ~ beta * pred_chl*pred_nh4*alpha*omega/(omega+pred_nh4) - death1*pred_chl - death2*(pred_chl^2)
),
## consider using bbmle::dnorm_n ?
observation = list(
nh4 ~ dnorm2(mean = pred_nh4),
chl ~ dnorm2(mean = pred_chl)
),
initial = list(pred_nh4 ~ pred_nh40 , pred_chl ~ pred_chl0),
par=c("alpha", "beta", "omega", "death1","death2", "pred_nh40", "pred_chl0", "gamma")
)
set.seed(100)
hc <- improvedLHS(300, 8)
hc <- data.frame(hc)
## 27 at 30%
hc[,1] <- 0.004+0.008*hc[,1]
hc[,2] <- 12 +  21.2*hc[,2]
hc[,3] <- 9 + 18.5*hc[,3]
hc[,4] <- 0.002 + 0.004*hc[,4]
hc[,5] <- 0.0004 + 0.0009*hc[,4]
hc[,6] <- 13
hc[,7] <- 40
hc[,8] <- 0.06 + 0.15*hc[,7]
cv <- vector(length= 300, mode = "list")
names(hc) <- c("alpha","beta","omega","death1","death2","pred_nh40","pred_chl0","gamma")
for(i in 1:nrow(hc)) {
newstart <- with(hc[i,],
list(
alpha =  alpha,
beta = beta,
omega = omega,
death1=death1,
death2 = death2,
pred_nh40 = pred_nh40,
pred_chl0 = pred_chl0,
gamma = gamma
))
x <- system.time({
tempm <- try((fitode(chl_nh4_mod, data= dat_nit_27, start = newstart, tcol = "date1",
solver.opts = list(method="rk4", hini=0.1))),silent = TRUE)
if (class(tempm) == "try-error") {
temp[i,] <- "NA"
cv[[i]] <- "NA"
} else {
temp[i,1:8] <- coef(tempm)
temp$loglik[i] <- logLik(tempm)
cv[[i]] <- vcov(tempm)
}})
temp$ttime[i] <- x[[3]]
print(i/nrow(hc))
}
set.seed(100)
hc <- improvedLHS(300, 8)
hc <- data.frame(hc)
## 27 at 30%
hc[,1] <- 0.004+0.008*hc[,1]
hc[,2] <- 12 +  21.2*hc[,2]
hc[,3] <- 9 + 18.5*hc[,3]
hc[,4] <- 0.002 + 0.004*hc[,4]
hc[,5] <- 0.0004 + 0.0009*hc[,4]
hc[,6] <- 13
hc[,7] <- 40
hc[,8] <- 0.06 + 0.15*hc[,8]
cv <- vector(length= 300, mode = "list")
names(hc) <- c("alpha","beta","omega","death1","death2","pred_nh40","pred_chl0","gamma")
for(i in 1:nrow(hc)) {
newstart <- with(hc[i,],
list(
alpha =  alpha,
beta = beta,
omega = omega,
death1=death1,
death2 = death2,
pred_nh40 = pred_nh40,
pred_chl0 = pred_chl0,
gamma = gamma
))
x <- system.time({
tempm <- try((fitode(chl_nh4_mod, data= dat_nit_27, start = newstart, tcol = "date1",
solver.opts = list(method="rk4", hini=0.1))),silent = TRUE)
if (class(tempm) == "try-error") {
temp[i,] <- "NA"
cv[[i]] <- "NA"
} else {
temp[i,1:8] <- coef(tempm)
temp$loglik[i] <- logLik(tempm)
cv[[i]] <- vcov(tempm)
}})
temp$ttime[i] <- x[[3]]
print(i/nrow(hc))
}
nrow(temp)
write.csv(temp, file = "nh4_27_allparam_30.csv")
saveRDS(cv, file = "nh4_27_allparam30_cov.RDS")
chl9_all <- read.csv(file = "chl_9_allparam_30.csv")
vcv9 <- readRDS(file = "chl9_allparams_30.RDS" )
chl27_all <- read.csv(file =" nh4_27_allparam_30")
chl27_all <- read.csv(file =" nh4_27_allparam_30.csv")
setwd("C:/Users/Jo/OneDrive/Documents/GitHub/Species-Traits/Nitrogen_Algae")
chl27_all <- read.csv(file =" nh4_27_allparam_30.csv")
chl27_all <- read.csv(file =" nh4_27_allparam_30.csv")
setwd("C:/Users/Jo/OneDrive/Documents/GitHub/Species-Traits/Nitrogen_Algae")
chl27_all <- read.csv(file ="nh4_27_allparam_30.csv")
vcv27 <- readRDS(file = "nh4_27_allparam30_cov.RDS")
chl3_all <- read.csv(file = "Nh4_3_allparam_30.csv")
vcv3 <- readRDS(file = "Nh4_3_allparam30_cov.RDS")
chl27_all$corrgood <- 0
chl27_all$corrgood <- 0
for (i in 1:length(vcv27)) {
if (vcv27[[i]] != "NA" & !is.na(vcv27[[i]][1])) {
vcv27[[i]] <- cov2cor(vcv27[[i]])
t <- length(which(vcv27[[i]] >1 ))
v <- length(which(vcv27[[i]] < -1))
if (t ==0 & v == 0)   {
chl27_all$corrgood[i] <- 1 }
}
}
warnings()
str(chl27_all)
max(chl27_all$loglik)
chl27 <- chl27_all %>% filter(alpha != "NA" & loglik > -500)
with(chl27, plot(loglik))
chl27 <- chl27_all %>% filter(alpha != "NA" & loglik > -440)
with(chl27, plot(loglik))
nrow(chl27_all %>% filter(corrgood == 1))
chl <- chl27_all %>% filter(loglik != "NA") %>% filter(loglik > -440)
chl1 <- chl %>% filter(corrgood == 1)
nrow(chl1)
chl2 <- chl %>% gather(key = "parameter", value = "value", -c(ttime,loglik,corrgood,X))
ggplot(chl2, aes(loglik, value)) + geom_point(aes(color= as.factor(corrgood))) +
facet_wrap(~parameter, scale = "free")
chl9_all <- read.csv(file = "chl_9_allparam_30.csv")
head(chl9_all)
head(chl3_all)
vcv27[[3]]
chl3_all$corrgood <- 0
chl3_all$corrgood <- 0
for (i in 1:length(vcv3)) {
if (vcv3[[i]] != "NA" & !is.na(vcv3[[i]][1])) {
vcv3[[i]] <- cov2cor(vcv3[[i]])
t <- length(which(vcv3[[i]] >1 ))
v <- length(which(vcv3[[i]] < -1))
if (t ==0 & v == 0)   {
chl3_all$corrgood[i] <- 1 }
}
}
head(chl3_all)
max(chl3_all$loglik)
chl3n <-chl3_all %>% filter(alpha != "NA" & loglik > -320)
with(chl3n, plot(loglik))
chl3n <-chl3_all %>% filter(alpha != "NA" & loglik > -285)
with(chl3n, plot(loglik))
nrow(chl3n)
nrow(chl3_all %>% filter(corrgood == 1))
warnings()
chl <- chl3_all %>% filter(loglik != "NA") %>% filter(loglik > -285)
chl2 <- chl %>% gather(key = "parameter", value = "value", -c(ttime,loglik,corrgood,X))
ggplot(chl2, aes(loglik, value)) + geom_point(aes(color= as.factor(corrgood))) +
facet_wrap(~parameter, scale = "free")
head(chl2)
vcv3[[1]]
vcv3[[6]]
chl54_all <- read.csv(file = "nh4_54_allparam_30.csv")
vcv54 <- readRDS(file = "nh4_54_allparam30_cov.RDS")
chl54_all$corrgood <- 0
for (i in 1:length(vcv54)) {
if (vcv54[[i]] != "NA" & !is.na(vcv54[[i]][1])) {
vcv54[[i]] <- cov2cor(vcv54[[i]])
t <- length(which(vcv54[[i]] >1 ))
v <- length(which(vcv54[[i]] < -1))
if (t ==0 & v == 0)   {
chl54_all$corrgood[i] <- 1 }
}
}
max(chl54$loglik)
max(chl54_all$loglik)
chl54 <-chl54_all %>% filter(alpha != "NA" & loglik > -450)
with(chl54, plot(loglik))
chl54 <-chl54_all %>% filter(alpha != "NA" & loglik > -430)
with(chl54, plot(loglik))
chl54 <-chl54_all %>% filter(alpha != "NA" & loglik > -425)
with(chl54, plot(loglik))
nrow(chl54_all %>% filter(corrgood == 1))
chl <- chl54_all %>% filter(loglik != "NA") %>% filter(loglik > -425)
chl2 <- chl %>% gather(key = "parameter", value = "value", -c(ttime,loglik,corrgood,X))
ggplot(chl2, aes(loglik, value)) + geom_point(aes(color= as.factor(corrgood))) +
facet_wrap(~parameter, scale = "free")
ggplot(chl, aes(alpha, beta)) + geom_point(aes(color = as.factor(corrgood)))
ggplot(chl, aes(alpha, omega)) + geom_point(aes(color = as.factor(corrgood)))
ggplot(chl[chl$omega < 10000, ], aes(alpha, omega)) + geom_point(aes(color = as.factor(corrgood)))
ggplot(chl[chl$omega < 1000, ], aes(alpha, omega)) + geom_point(aes(color = as.factor(corrgood)))
ggplot(chl, aes(alpha, death2)) + geom_point(aes(color = as.factor(corrgood)))
ggplot(chl, aes(alpha, death1)) + geom_point(aes(color = as.factor(corrgood)))
ggplot(chl, aes(alpha, gamma)) + geom_point(aes(color = as.factor(corrgood)))
ggplot(chl, aes(beta, omega)) + geom_point(aes(color = as.factor(corrgood)))
ggplot(chl[chl$omega < 1000, ], aes(beta, omega)) + geom_point(aes(color = as.factor(corrgood)))
ggplot(chl[chl$omega < 200, ], aes(alpha, omega)) + geom_point(aes(color = as.factor(corrgood)))
ggplot(chl[chl$omega < 200, ], aes(beta, omega)) + geom_point(aes(color = as.factor(corrgood)))
ggplot(chl, aes(beta, death2)) + geom_point(aes(color = as.factor(corrgood)))
ggplot(chl, aes(beta, death1)) + geom_point(aes(color = as.factor(corrgood)))
ggplot(chl, aes(beta, gamma)) + geom_point(aes(color = as.factor(corrgood)))
ggplot(chl[chl$gamma < 1000, ], aes(alpha, gamma)) + geom_point(aes(color = as.factor(corrgood)))
ggplot(chl[chl$gamma < 1000, ], aes(beta, gamma)) + geom_point(aes(color = as.factor(corrgood)))
ggplot(chl[chl$omega < 200, ], aes(omega, death2)) + geom_point(aes(color = as.factor(corrgood)))
ggplot(chl[chl$omega < 200, ], aes(omega, death1)) + geom_point(aes(color = as.factor(corrgood)))
ggplot(chl[chl$gamma < 1000, ], aes(omega, gamma)) + geom_point(aes(color = as.factor(corrgood)))
ggplot(chl, aes(death2, death1)) + geom_point(aes(color = as.factor(corrgood)))
ggplot(chl, aes(death2, gamma)) + geom_point(aes(color = as.factor(corrgood)))
ggplot(chl[chl$gamma < 1000, ], aes(death2, gamma)) + geom_point(aes(color = as.factor(corrgood)))
ggplot(chl[chl$gamma < 1000, ], aes(death1, gamma)) + geom_point(aes(color = as.factor(corrgood)))
med_param_54 <- chl1 %>%
gather(key = "parameter", value = "value", -c(ttime,loglik,corrgood,X)) %>%
select (-c(ttime,loglik,corrgood,X))  %>%
group_by(parameter) %>%
summarize(parmmed = median(value))
newstart <- setNames(med_param_54$parmmed, as.character(med_param_9$parameter))
newstart <- setNames(med_param_54$parmmed, as.character(med_param_54$parameter))
cammonium = 0.04085 # proportional ammonium lost to env-- calc in nutrient_air.R
chl_nh4_mod <- new("model.ode",
name = "algal_nit",
model = list(
pred_nh4 ~ -pred_chl*pred_nh4*alpha*omega/(omega+pred_nh4) + gamma *(death1*pred_chl + death2*(pred_chl^2))-cammonium*pred_nh4 ,
pred_chl ~ beta * pred_chl*pred_nh4*alpha*omega/(omega+pred_nh4) - death1*pred_chl - death2*(pred_chl^2)
),
## consider using bbmle::dnorm_n ?
observation = list(
nh4 ~ dnorm2(mean = pred_nh4),
chl ~ dnorm2(mean = pred_chl)
),
initial = list(pred_nh4 ~ pred_nh40 , pred_chl ~ pred_chl0),
par=c("alpha", "beta", "omega", "death1","death2", "pred_nh40", "pred_chl0", "gamma")
)
ss <- ode.solve(chl_nh4_mod, 1:11, newstart,
solver.opts=list(method="rk4", hini=0.1))
med_param_54
chl1
med_param_54 <- chl %>%
gather(key = "parameter", value = "value", -c(ttime,loglik,corrgood,X)) %>%
select (-c(ttime,loglik,corrgood,X))  %>%
group_by(parameter) %>%
summarize(parmmed = median(value))
med_param_54
ss <- ode.solve(chl_nh4_mod, 1:11, newstart,
solver.opts=list(method="rk4", hini=0.1))
newstart <- setNames(med_param_54$parmmed, as.character(med_param_54$parameter))
ss <- ode.solve(chl_nh4_mod, 1:11, newstart,
solver.opts=list(method="rk4", hini=0.1))
dat_nit_54 <- dat %>%
filter(treat == 54)
dat <- read.csv("Algae_Nutrient.csv")
dat_nit_54 <- dat %>%
filter(treat == 54)
plot(dat_nit_54$date1, dat_nit_54$nh4) #, ylim=c(0, 30))
lines(ss@solution$pred_nh4)
plot(dat_nit_54$date1, dat_nit_54$chl)
lines(ss@solution$pred_chl)
chl1 <- chl %>% filter(corrgood == 1)
nrow(chl1)
med_param_54a <- chl1 %>%
gather(key = "parameter", value = "value", -c(ttime,loglik,corrgood,X)) %>%
select (-c(ttime,loglik,corrgood,X))  %>%
group_by(parameter) %>%
summarize(parmmed = median(value))
newstart1 <- setNames(med_param_54a$parmmed, as.character(med_param_54a$parameter))
ss1 <- ode.solve(chl_nh4_mod, 1:11, newstart1,
solver.opts=list(method="rk4", hini=0.1))
plot(dat_nit_54$date1, dat_nit_54$nh4) #, ylim=c(0, 30))
lines(ss1@solution$pred_nh4)
plot(dat_nit_54$date1, dat_nit_54$chl)
lines(ss1@solution$pred_chl)
lines(ss@solution$pred_chl, col= "blue")
plot(dat_nit_54$date1, dat_nit_54$nh4) #, ylim=c(0, 30))
lines(ss1@solution$pred_nh4)
lines(ss@solution$pred_nh4, col = "blue")
med_param_54a
chl9_all <- read.csv(file = "chl_9_allparam_30.csv")
vcv9 <- readRDS(file = "chl9_allparams_30.RDS" )
chl9_all$corrgood <- 0
for (i in 1:length(vcv9)) {
if (vcv9[[i]] != "NA" & !is.na(vcv9[[i]][1])) {
vcv9[[i]] <- cov2cor(vcv9[[i]])
t <- length(which(vcv9[[i]] >1 ))
v <- length(which(vcv9[[i]] < -1))
if (t ==0 & v == 0)   {
chl9_all$corrgood[i] <- 1 }
}
}
chl9n <- chl9 %>% filter(alpha != "NA" & loglik > -320)
with(chl9n[chl9n$loglik > -350, ], plot(loglik))
chl9n <- chl9 %>% filter(alpha != "NA" & loglik > -320)
chl9n <- chl9_all %>% filter(alpha != "NA" & loglik > -320)
with(chl9n[chl9n$loglik > -350, ], plot(loglik))
chl9n <- chl9_all %>% filter(alpha != "NA" & loglik > -500)
with(chl9n[chl9n$loglik > -350, ], plot(loglik))
max(chl9_all$loglik)
chl9n <- chl9_all %>% filter(alpha != "NA" & loglik > -500)
with(chl9n[chl9n$loglik > -350, ], plot(loglik))
with(chl9n[chl9n$loglik > -500, ], plot(loglik))
chl9n <- chl9_all %>% filter(alpha != "NA" & loglik > -450)
with(chl9n, plot(loglik))
chl9n <- chl9_all %>% filter(alpha != "NA" & loglik > -435)
with(chl9n, plot(loglik))
nrow(chl9_all %>% filter(corrgood == 1))
nrow(chl9n %>% filter(corrgood == 1))
chl <- chl9_all %>% filter(loglik != "NA") %>% filter(loglik > -432)
chl1 <- chl %>% filter(corrgood == 1)
chl2 <- chl %>% gather(key = "parameter", value = "value", -c(ttime,loglik,corrgood,X))
ggplot(chl2, aes(loglik, value)) + geom_point(aes(color= as.factor(corrgood))) +
facet_wrap(~parameter, scale = "free")
ggplot(chl, aes(alpha, beta)) + geom_point(aes(color = as.factor(corrgood)))
ggplot(chl, aes(alpha, omega)) + geom_point(aes(color = as.factor(corrgood)))
ggplot(chl, aes(alpha, death2)) + geom_point(aes(color = as.factor(corrgood)))
ggplot(chl, aes(alpha, death1)) + geom_point(aes(color = as.factor(corrgood)))
ggplot(chl, aes(alpha, gamma)) + geom_point(aes(color = as.factor(corrgood)))
ggplot(chl, aes(beta, omega)) + geom_point(aes(color = as.factor(corrgood)))
ggplot(chl, aes(beta, death2)) + geom_point(aes(color = as.factor(corrgood)))
ggplot(chl, aes(beta, death1)) + geom_point(aes(color = as.factor(corrgood)))
ggplot(chl, aes(beta, gamma)) + geom_point(aes(color = as.factor(corrgood)))
ggplot(chl, aes(omega, death2)) + geom_point(aes(color = as.factor(corrgood)))
ggplot(chl, aes(omega, death1)) + geom_point(aes(color = as.factor(corrgood)))
ggplot(chl, aes(omega, gamma)) + geom_point(aes(color = as.factor(corrgood)))
ggplot(chl, aes(death2, death1)) + geom_point(aes(color = as.factor(corrgood)))
ggplot(chl, aes(death2, gamma)) + geom_point(aes(color = as.factor(corrgood)))
ggplot(chl, aes(death1, gamma)) + geom_point(aes(color = as.factor(corrgood)))
ggplot(chl, aes(death1, gamma)) + geom_point(aes(color = as.factor(corrgood)))
med_param_9 <- chl1 %>%
gather(key = "parameter", value = "value", -c(ttime,loglik,corrgood,X)) %>%
select (-c(ttime,loglik,corrgood,X))  %>%
group_by(parameter) %>%
summarize(parmmed = median(value))
newstart <- setNames(med_param_9$parmmed, as.character(med_param_9$parameter))
ss <- ode.solve(chl_nh4_mod, 1:11, newstart,
solver.opts=list(method="rk4", hini=0.1))
plot(dat_nit_9$date1, dat_nit_9$nh4, ylim=c(0, 30))
dat_nit_9 <- dat %>%
filter(treat == 9)
plot(dat_nit_9$date1, dat_nit_9$nh4, ylim=c(0, 30))
lines(ss@solution$pred_nh4)
plot(dat_nit_9$date1, dat_nit_9$chl)
lines(ss@solution$pred_chl)
med_param_54a
med_param_9
newstart[[8]] <- 8
newstart[[7]] <- 40
ss <- ode.solve(chl_nh4_mod, 1:11, newstart,
solver.opts=list(method="rk4", hini=0.1))
plot(dat_nit_9$date1, dat_nit_9$nh4, ylim=c(0, 30))
lines(ss@solution$pred_nh4)
plot(dat_nit_9$date1, dat_nit_9$chl)
lines(ss@solution$pred_chl)
head(chl3_all)
chl <- chl3_all %>% filter(loglik != "NA") %>% filter(loglik > -285)
med_param_3<- chl %>%
gather(key = "parameter", value = "value", -c(ttime,loglik,corrgood,X)) %>%
select (-c(ttime,loglik,corrgood,X))  %>%
group_by(parameter) %>%
summarize(parmmed = median(value))
newstart <- setNames(med_param_3$parmmed, as.character(med_param_3$parameter))
ss <- ode.solve(chl_nh4_mod, 1:11, newstart,
solver.opts=list(method="rk4", hini=0.1))
plot(dat_nit_9$date1, dat_nit_9$nh4, ylim=c(0, 30))
dat_nit_3 <- dat %>%
filter(treat == 3)
plot(dat_nit_3$date1, dat_nit_3$nh4, ylim=c(0, 30))
lines(ss@solution$pred_nh4)
plot(dat_nit_3$date1, dat_nit_3$chl)
lines(ss@solution$pred_chl)
med_param_3
4.58e-3
left_join(med_param_3,med_param_54a,med_param_9, by = "parameter")
med_param_9 <- chl1 %>%
gather(key = "parameter", value = "value", -c(ttime,loglik,corrgood,X)) %>%
select (-c(ttime,loglik,corrgood,X))  %>%
group_by(parameter) %>%
summarize(parmmed = median(value))
left_join(med_param_3,med_param_54a,med_param_9, by = "parameter")
left_join(left_join(med_param_3,med_param_54a, by = "parameter"),med_param_9, by= "parameter")
